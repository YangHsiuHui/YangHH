<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>æª”æ¡ˆç®¡ç†ç³»çµ±</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#fdfaf7;
  --panel:#ffffff;
  --muted:#6f625a;
  --accent:#c0703c; /* æš–è‰² */
  --accent-light:#f1dfd4;
  --danger:#d9534f;
  --success:#2e8b57;
  --radius:12px;
  --shadow:0 6px 18px rgba(0,0,0,0.05);
}
*{box-sizing:border-box;font-family:"Inter",sans-serif;}
body,html{margin:0;height:100%;background:var(--bg);color:#2b2b2b}
.app{display:flex;min-height:100vh}

/* Sidebar */
.sidebar{
  width:240px;background:var(--panel);border-right:1px solid #eee;
  padding:20px;display:flex;flex-direction:column;box-shadow:var(--shadow)
}
.logo{
  width:60px;height:60px;border-radius:12px;
  background:linear-gradient(135deg,var(--accent),#f0b087);
  display:flex;align-items:center;justify-content:center;
  color:#fff;font-weight:700;font-size:18px;margin-bottom:10px
}
.brand{font-size:16px;font-weight:700;margin-bottom:20px}
.menu{display:flex;flex-direction:column;gap:8px}
.menu-item{padding:10px;border-radius:10px;cursor:pointer;font-weight:600;color:var(--accent)}
.menu-item:hover{background:var(--accent-light)}
.menu-item.active{background:var(--accent-light);box-shadow:inset 0 0 0 1px #e3c9b5}

/* Main */
.main{flex:1;padding:20px}
.topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
.card{background:var(--panel);padding:16px;border-radius:var(--radius);box-shadow:var(--shadow);margin-bottom:20px}
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid #eee;font-size:14px}
th{color:var(--muted);text-align:left;font-size:13px}
.status{padding:4px 8px;border-radius:999px;font-size:12px}
.draft{background:#fff3e0;color:#c0703c}
.review{background:#fdecea;color:#b54b4b}
.approved{background:#e8f6ef;color:#1f8a52}

/* Buttons */
.btn{padding:8px 12px;border:0;border-radius:8px;font-weight:600;cursor:pointer}
.btn.primary{background:var(--accent);color:#fff}
.btn.ghost{background:transparent;border:1px solid #ddd;color:var(--accent)}
.btn.danger{background:var(--danger);color:#fff}
.btn.small{font-size:12px;padding:5px 8px}

/* Login overlay */
.login-wrap{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.2)}
.login{background:var(--panel);padding:24px;border-radius:12px;box-shadow:var(--shadow);width:360px}
.login h2{margin-top:0}
.field{display:flex;flex-direction:column;gap:6px;margin-top:10px}
.field input{padding:10px;border-radius:8px;border:1px solid #ccc}

/* Responsive */
@media(max-width:768px){
  .sidebar{display:none}
}
</style>
</head>
<body>
<div class="app">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo">FM</div>
    <div class="brand">æª”æ¡ˆç®¡ç†ç³»çµ±</div>
    <div class="menu">
      <div class="menu-item active" data-view="dashboard">ğŸ“‚ æ–‡ä»¶é¦–é </div>
      <div class="menu-item" data-view="upload">â¬†ï¸ ä¸Šå‚³æ–‡ä»¶</div>
      <div class="menu-item" data-view="users">ğŸ‘¥ äººå“¡ç®¡ç†</div>
      <div class="menu-item" data-view="about">â„¹ï¸ èªªæ˜</div>
    </div>
  </aside>

  <!-- Main -->
  <main class="main">
    <div class="topbar">
      <h2 id="viewTitle">æ–‡ä»¶é¦–é </h2>
      <button class="btn ghost" id="logoutBtn">ç™»å‡º</button>
    </div>

    <!-- Dashboard -->
    <section id="dashboardView" class="card">
      <h3>æˆ‘çš„æ–‡ä»¶</h3>
      <table id="docTable">
        <thead><tr><th>æ–‡ä»¶åç¨±</th><th>ä¸Šå‚³è€…</th><th>ç‹€æ…‹</th><th>æ“ä½œ</th></tr></thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- Upload -->
    <section id="uploadView" class="card" style="display:none">
      <h3>ä¸Šå‚³æ–‡ä»¶</h3>
      <div class="field"><input type="file" id="fileInput" /></div>
      <button class="btn primary" id="uploadBtn">ä¸Šå‚³</button>
    </section>

    <!-- Users -->
    <section id="usersView" class="card" style="display:none">
      <h3>äººå“¡ç®¡ç†</h3>
      <div class="field"><input id="newUser" placeholder="è¼¸å…¥å¸³è™Ÿ"/></div>
      <select id="newRole">
        <option value="admin">Admin</option>
        <option value="editor">Editor</option>
        <option value="viewer">Viewer</option>
      </select>
      <button class="btn primary" id="addUser">æ–°å¢äººå“¡</button>
      <div id="userList" style="margin-top:12px"></div>
    </section>

    <!-- About -->
    <section id="aboutView" class="card" style="display:none">
      <h3>é—œæ–¼</h3>
      <p>é€™æ˜¯ã€Œæª”æ¡ˆç®¡ç†ç³»çµ±ã€å‰ç«¯ç¯„ä¾‹ã€‚åŒ…å«æ–‡ä»¶ä¸Šå‚³ã€ä¸‹è¼‰ã€ç‹€æ…‹ç®¡ç†ã€ç·¨è¼¯åˆªé™¤èˆ‡äººå“¡ç®¡ç†ã€‚</p>
    </section>
  </main>
</div>

<!-- Login -->
<div id="loginOverlay" class="login-wrap">
  <div class="login">
    <h2>ç™»å…¥æª”æ¡ˆç®¡ç†ç³»çµ±</h2>
    <div class="field"><label>å¸³è™Ÿ</label><input id="loginUser"></div>
    <div class="field"><label>å¯†ç¢¼</label><input id="loginPass" type="password"></div>
    <button class="btn primary" id="loginBtn">ç™»å…¥</button>
    <p style="font-size:12px;color:var(--muted)">æ¸¬è©¦å¸³è™Ÿï¼šadmin / editor / viewer (å¯†ç¢¼ä»»æ„)</p>
  </div>
</div>

<script>
const DB_USERS="fm_users",DB_DOCS="fm_docs";
function initData(){
  if(!localStorage.getItem(DB_USERS)){
    localStorage.setItem(DB_USERS,JSON.stringify([
      {id:"admin",role:"admin"},
      {id:"editor",role:"editor"},
      {id:"viewer",role:"viewer"}
    ]));
  }
  if(!localStorage.getItem(DB_DOCS)){
    localStorage.setItem(DB_DOCS,JSON.stringify([]));
  }
}
initData();

let currentUser=null;
const loginOverlay=document.getElementById("loginOverlay");
document.getElementById("loginBtn").onclick=()=>{
  const u=document.getElementById("loginUser").value.trim();
  const users=JSON.parse(localStorage.getItem(DB_USERS));
  const found=users.find(x=>x.id===u);
  if(found){currentUser=found;loginOverlay.style.display="none";renderDocs();renderUsers();}
  else alert("ç„¡æ­¤å¸³è™Ÿ");
};
document.getElementById("logoutBtn").onclick=()=>{currentUser=null;loginOverlay.style.display="flex";};

/* Navigation */
document.querySelectorAll(".menu-item").forEach(item=>{
  item.onclick=()=>{
    document.querySelectorAll(".menu-item").forEach(i=>i.classList.remove("active"));
    item.classList.add("active");
    const v=item.dataset.view;
    document.getElementById("viewTitle").innerText=item.innerText;
    ["dashboardView","uploadView","usersView","aboutView"].forEach(id=>document.getElementById(id).style.display="none");
    if(v==="dashboard")document.getElementById("dashboardView").style.display="block";
    if(v==="upload")document.getElementById("uploadView").style.display="block";
    if(v==="users")document.getElementById("usersView").style.display="block";
    if(v==="about")document.getElementById("aboutView").style.display="block";
  };
});

/* Documents */
function renderDocs(){
  const docs=JSON.parse(localStorage.getItem(DB_DOCS));
  const tbody=document.querySelector("#docTable tbody");
  tbody.innerHTML="";
  docs.forEach((d,i)=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${d.name}</td><td>${d.owner}</td>
      <td><span class="status ${d.status}">${d.status}</span></td>
      <td>
        <button class="btn small ghost" onclick="downloadDoc(${i})">ä¸‹è¼‰</button>
        ${currentUser.role!=="viewer"?`
        <button class="btn small" onclick="editDoc(${i})">ç·¨è¼¯</button>
        <button class="btn small danger" onclick="deleteDoc(${i})">åˆªé™¤</button>`:""}
      </td>`;
    tbody.appendChild(tr);
  });
}
function downloadDoc(i){
  alert("æ¨¡æ“¬ä¸‹è¼‰ï¼š"+JSON.parse(localStorage.getItem(DB_DOCS))[i].name);
}
function editDoc(i){
  const docs=JSON.parse(localStorage.getItem(DB_DOCS));
  const d=docs[i];
  const newStatus=prompt("è¼¸å…¥æ–°ç‹€æ…‹ draft/review/approved",d.status);
  if(newStatus)d.status=newStatus;
  localStorage.setItem(DB_DOCS,JSON.stringify(docs));
  renderDocs();
}
function deleteDoc(i){
  const docs=JSON.parse(localStorage.getItem(DB_DOCS));
  docs.splice(i,1);
  localStorage.setItem(DB_DOCS,JSON.stringify(docs));
  renderDocs();
}
document.getElementById("uploadBtn").onclick=()=>{
  const f=document.getElementById("fileInput").files[0];
  if(!f)return alert("è«‹é¸æª”");
  const docs=JSON.parse(localStorage.getItem(DB_DOCS));
  docs.push({name:f.name,owner:currentUser.id,status:"draft"});
  localStorage.setItem(DB_DOCS,JSON.stringify(docs));
  renderDocs();
  alert("ä¸Šå‚³å®Œæˆ");
};

/* Users */
function renderUsers(){
  const users=JSON.parse(localStorage.getItem(DB_USERS));
  const list=document.getElementById("userList");
  list.innerHTML="";
  users.forEach((u,i)=>{
    const div=document.createElement("div");
    div.textContent=u.id+" ("+u.role+")";
    if(currentUser.role==="admin" && u.id!=="admin"){
      const del=document.createElement("button");
      del.textContent="åˆªé™¤";del.className="btn small danger";del.onclick=()=>{
        users.splice(i,1);
        localStorage.setItem(DB_USERS,JSON.stringify(users));
        renderUsers();
      };
      div.appendChild(del);
    }
    list.appendChild(div);
  });
}
document.getElementById("addUser").onclick=()=>{
  if(currentUser.role!=="admin")return alert("åªæœ‰Adminå¯æ–°å¢");
  const id=document.getElementById("newUser").value.trim();
  const role=document.getElementById("newRole").value;
  if(!id)return;
  const users=JSON.parse(localStorage.getItem(DB_USERS));
  users.push({id,role});
  localStorage.setItem(DB_USERS,JSON.stringify(users));
  renderUsers();
};
</script>
</body>
</html>